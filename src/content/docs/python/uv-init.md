---
title: uvでプロジェクトを作成する
description: uvでPythonプロジェクトを作成・管理する手順を詳細に解説しています。
sidebar:
  label: プロジェクトの作成
  order: 0
---

uvは`pyproject.toml`や`uv.lock`といったメタデータファイルを活用して、パッケージの依存関係を効率的に管理します。このガイドでは、uvを使用してPythonプロジェクトを作成し、管理する方法を詳しく説明します。

uvが使用できる状態になっていない場合は、[uvのセットアップ](../../environments/setup-uv/)を参考にしてセットアップしてください。

## プロジェクトの作成と初期設定

### 1. 新しいプロジェクトの作成

```bash
uv init [プロジェクト名]
```

このコマンドにより、以下のファイルが作成されます：

- `README.md`: プロジェクトの説明文書
- `hello.py`: サンプルPythonスクリプト
- `pyproject.toml`: プロジェクトの設定と依存関係を管理するファイル
- `.python-version`: 使用するPythonのバージョンを指定するファイル

また、ローカルのGitリポジトリも同時に初期化されます。これにより、バージョン管理をすぐに開始できます。

### 2. Pythonバージョンの指定

```bash
uv python pin 3.12
```

uvでは、プロジェクトごとに使用するPythonのバージョンを選択できます。このコマンドにより、`.python-version`ファイルが更新され、プロジェクトで使用するPythonのバージョンが3.12に設定されます。

バージョンは必要に応じて変更可能です。例えば、3.11を使用したい場合は`uv python pin 3.11`とします。

### 3. 環境のセットアップ

```bash
uv sync
```

`uv sync`コマンドは、`pyproject.toml`と`uv.lock`ファイルをもとに、環境を同期させます。具体的には：

1. 指定されたPythonバージョンをインストール（未インストールの場合）
2. 仮想環境の作成
3. `pyproject.toml`に記載された依存パッケージのインストール

このコマンドは、新しい開発者がプロジェクトをクローンした後や、依存関係が変更された後に実行します。

## パッケージ管理

### パッケージのインストール

```bash
uv add [パッケージ名]
```

このコマンドにより：

1. 指定したパッケージがインストールされます。
2. `pyproject.toml`の`[project].dependencies`セクションに、パッケージ名とバージョンが追加されます。
3. `uv.lock`ファイルが更新され、正確なバージョン情報が記録されます。

### パッケージの削除

```bash
uv remove [パッケージ名]
```

このコマンドにより：

1. 指定したパッケージが環境から削除されます。
2. `pyproject.toml`からパッケージの記述が削除されます。
3. `uv.lock`ファイルが更新されます。

### 依存関係の表示

```bash
uv tree
```

このコマンドは、インストールされているパッケージとその依存関係を階層構造で表示します。これにより、プロジェクトの依存関係を視覚的に理解できます。

## 開発ツールのインストール

開発環境でのみ使用するツール（Linter、Formatter等）は、`pyproject.toml`の`[tool.uv].dev-dependencies`セクションに記述します。これにより、Pythonパッケージを配布する際に不要なパッケージを除外できます。

```bash
uv tool install [ツール名]
```

例：Ruff（PythonのLinter/Formatter）のインストール

```bash
uv tool install ruff
```

このコマンドにより：

1. Ruffがインストールされます。
2. `pyproject.toml`の`[tool.uv].dev-dependencies`セクションにRuffが追加されます。

## コードの実行

### 1. uvを使用して直接実行

```bash
uv run python [ファイル名]
```

このコマンドは、uvが管理する仮想環境内でPythonスクリプトを実行します。

### 2. 仮想環境の有効化（従来の方法）

```bash
. .venv/bin/activate
python [ファイル名]
```

仮想環境を有効化した後は、通常のpythonコマンドでスクリプトを実行できます。

仮想環境を無効化する場合：

```bash
deactivate
```

## Visual Studio Codeでの使用

1. コマンドパレットを開く（Command + Shift + PまたはCtrl + Shift + P）
2. "Python: Select Interpreter" を選択
3. `./.venv/bin/python` のパスを選択

この設定により、VS Code内でuvで構築した環境を使用してコードを実行やデバッグできます。

## 既存プロジェクトのuvへの移行

1. プロジェクトディレクトリで `uv init` を実行
   - これにより、uvの設定ファイルが作成されます。
2. 必要なパッケージを `pyproject.toml` に追記または `uv add` でインストール
   - 既存の依存関係リスト（requirements.txt等）がある場合は、それを参考に追加します。
3. `uv sync` で環境を同期
   - これにより、新しい仮想環境が作成され、必要なパッケージがインストールされます。

Poetry や Rye からの移行の場合、既存の `pyproject.toml` があれば `uv sync` のみで開始可能です。uvは他のツールとの互換性が高いため、スムーズな移行が可能です。

## 注意点と補足

- uvでは `pip` コマンドの代わりに `uv` コマンドを使用します。
- pip互換のコマンドとして `uv pip` も利用可能です（例：`uv pip install [パッケージ名]`）
- uvは高速で効率的なパッケージ管理を提供し、他の環境構築ツールとの互換性も高いため、多くのPythonプロジェクトで採用することができます。
- `uv.lock`ファイルを使用することで、開発者間で完全に同一の環境を再現することができます。
